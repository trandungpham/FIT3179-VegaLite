{
    "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
    "description": "Australian map showing airports sized by number of international routes.",
    "width": 900,
    "height": 600,
  
    "projection": {
      "type": "mercator",
      "center": [133, -27],
      "scale": 900,
      "translate": [450, 300]
    },
  
    "layer": [
      {
        "mark": {"type": "geoshape", "fill": "#f4f4f4", "stroke": "#cccccc"},
        "data": {
          "url": "https://raw.githubusercontent.com/trandungpham/FIT3179-VegaLite/refs/heads/main/js/ne_110m_admin_0_countries.topojson",
          "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
        },
        "transform": [
          {
            "filter": "datum.properties.name == 'Australia'"
          }
        ]
      },
  
      {
        "mark": {"type": "circle", "stroke": "white", "strokeWidth": 0.7},
        "data": {"url": "../data/unique_routes.csv"},
        "transform": [
          {
            "aggregate": [{"op": "count", "as": "routes"}],
            "groupby": ["AustralianPort"]
          },
          {
            "lookup": "AustralianPort",
            "from": {
              "data": {"url": "../data/city_coordinates.csv"},
              "key": "city",
              "fields": ["latitude", "longitude"]
            }
          },
          {
            "filter": "isValid(datum.latitude) && isValid(datum.longitude)"
          }
        ],
        "encoding": {
          "latitude": {"field": "latitude"},
          "longitude": {"field": "longitude"},
          "size": {
            "field": "routes",
            "type": "quantitative",
            "title": "Number of Routes",
            "scale": {"range": [80, 1500]}
          },
          "color": {
            "field": "routes",
            "type": "quantitative",
            "title": "Routes",
            "scale": {"scheme": "blues"}
          },
          "tooltip": [
            {"field": "AustralianPort", "title": "Airport"},
            {"field": "routes", "title": "Number of Routes"}
          ]
        }
      }
    ]
  }
  